{"ast":null,"code":"import React from\"react\";import{useEffect,useRef}from\"react\";import'./preview.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var html=\"\\n    <html>\\n      <head>\\n        <style> html {background-color: white} </style>\\n      </head>\\n      <body>\\n        <div id=\\\"root\\\"></div>\\n        <script>\\n          const handleError = (err) => {\\n              const root = document.querySelector('#root');\\n                  root.innerHTML = '<div style=\\\"color: red;\\\"><h4>Runtime Error</h4>' + err + '</div>';\\n                  console.error(err)\\n          };\\n          \\n          window.addEventListener('error', (event) => {\\n              event.preventDefault();\\n              handleError(event.error);\\n          });\\n          window.addEventListener('message', (event) => {\\n              <!-- Error catch -->\\n              try{\\n                   eval(event.data);\\n              }catch (err) {\\n                 handleError(err);\\n                  <!-- Check error optional-->\\n              }\\n          }, false);\\n        </script>\\n      </body>\\n    </html>\\n  \";var Preview=function Preview(_ref){var code=_ref.code,bundlingStatus=_ref.bundlingStatus;var iframe=useRef();useEffect(function(){iframe.current.srcdoc=html;setTimeout(function(){iframe.current.contentWindow.postMessage(code,'*');},50);},[code]);console.log(bundlingStatus);return/*#__PURE__*/_jsxs(\"div\",{className:\"preview-wrapper\",children:[/*#__PURE__*/_jsx(\"iframe\",{title:\"preview\",ref:iframe,sandbox:\"allow-scripts\",srcDoc:html}),bundlingStatus&&/*#__PURE__*/_jsx(\"div\",{className:\"preview-error\",children:bundlingStatus})]});};export default Preview;","map":{"version":3,"sources":["/Users/tristanwhite/IdeaProjects/jbook/packages/local-client/src/components/preview.tsx"],"names":["React","useEffect","useRef","html","Preview","code","bundlingStatus","iframe","current","srcdoc","setTimeout","contentWindow","postMessage","console","log"],"mappings":"AAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAAQC,SAAR,CAAmBC,MAAnB,KAAgC,OAAhC,CACA,MAAO,eAAP,C,wFAOA,GAAMC,CAAAA,IAAI,o7BAAV,CAgCA,GAAMC,CAAAA,OAA+B,CAAG,QAAlCA,CAAAA,OAAkC,MAA2B,IAAzBC,CAAAA,IAAyB,MAAzBA,IAAyB,CAApBC,cAAoB,MAApBA,cAAoB,CAC/D,GAAMC,CAAAA,MAAM,CAAGL,MAAM,EAArB,CAEAD,SAAS,CAAC,UAAM,CACZM,MAAM,CAACC,OAAP,CAAeC,MAAf,CAAwBN,IAAxB,CACAO,UAAU,CAAC,UAAI,CACXH,MAAM,CAACC,OAAP,CAAeG,aAAf,CAA6BC,WAA7B,CAAyCP,IAAzC,CAA+C,GAA/C,EACH,CAFS,CAEP,EAFO,CAAV,CAGH,CALQ,CAKN,CAACA,IAAD,CALM,CAAT,CAOAQ,OAAO,CAACC,GAAR,CAAYR,cAAZ,EAEA,mBACI,aAAK,SAAS,CAAE,iBAAhB,wBACI,eACI,KAAK,CAAE,SADX,CAEI,GAAG,CAAEC,MAFT,CAGI,OAAO,CAAC,eAHZ,CAII,MAAM,CAAEJ,IAJZ,EADJ,CAOKG,cAAc,eAAI,YAAK,SAAS,CAAE,eAAhB,UAAkCA,cAAlC,EAPvB,GADJ,CAWH,CAvBD,CAyBA,cAAeF,CAAAA,OAAf","sourcesContent":["import React from \"react\";\nimport {useEffect, useRef} from \"react\";\nimport './preview.css';\n\ninterface PreviewProps{\n    code: string;\n    bundlingStatus: string;\n}\n\nconst html = `\n    <html>\n      <head>\n        <style> html {background-color: white} </style>\n      </head>\n      <body>\n        <div id=\"root\"></div>\n        <script>\n          const handleError = (err) => {\n              const root = document.querySelector('#root');\n                  root.innerHTML = '<div style=\"color: red;\"><h4>Runtime Error</h4>' + err + '</div>';\n                  console.error(err)\n          };\n          \n          window.addEventListener('error', (event) => {\n              event.preventDefault();\n              handleError(event.error);\n          });\n          window.addEventListener('message', (event) => {\n              <!-- Error catch -->\n              try{\n                   eval(event.data);\n              }catch (err) {\n                 handleError(err);\n                  <!-- Check error optional-->\n              }\n          }, false);\n        </script>\n      </body>\n    </html>\n  `;\n\nconst Preview: React.FC<PreviewProps> = ({code,bundlingStatus}) => {\n    const iframe = useRef<any>();\n\n    useEffect(() => {\n        iframe.current.srcdoc = html;\n        setTimeout(()=>{\n            iframe.current.contentWindow.postMessage(code, '*');\n        }, 50);\n    }, [code]);\n\n    console.log(bundlingStatus);\n\n    return (\n        <div className={\"preview-wrapper\"}>\n            <iframe\n                title={\"preview\"}\n                ref={iframe}\n                sandbox=\"allow-scripts\"\n                srcDoc={html}\n            />\n            {bundlingStatus && <div className={\"preview-error\"}>{bundlingStatus}</div>}\n        </div>\n    );\n}\n\nexport default Preview;\n"]},"metadata":{},"sourceType":"module"}