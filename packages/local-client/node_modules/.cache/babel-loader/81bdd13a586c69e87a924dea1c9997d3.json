{"ast":null,"code":"import * as esbuild from 'esbuild-wasm';\nimport { unpkgPathPlugin } from '../plugins/unpkg-path-plugins';\nimport { fetchPlugin } from '../plugins/fetch-plugin';\nlet service;\nexport default (async rawCode => {\n  if (!service) {\n    service = await esbuild.startService({\n      worker: true,\n      wasmURL: 'https://unpkg.com/esbuild-wasm@0.8.27/esbuild.wasm'\n    });\n  }\n\n  const result = await service.build({\n    entryPoints: ['index.js'],\n    bundle: true,\n    write: false,\n    plugins: [unpkgPathPlugin(), fetchPlugin(rawCode)],\n    define: {\n      'process.env.NODE_ENV': '\"production\"',\n      global: 'window'\n    }\n  });\n  return result.outputFiles[0].text;\n});","map":{"version":3,"sources":["/Users/tristanwhite/IdeaProjects/jbook/src/bundler/index.ts"],"names":["esbuild","unpkgPathPlugin","fetchPlugin","service","rawCode","startService","worker","wasmURL","result","build","entryPoints","bundle","write","plugins","define","global","outputFiles","text"],"mappings":"AAAA,OAAO,KAAKA,OAAZ,MAAyB,cAAzB;AACA,SAASC,eAAT,QAAgC,+BAAhC;AACA,SAASC,WAAT,QAA4B,yBAA5B;AAEA,IAAIC,OAAJ;AACA,gBAAe,MAAOC,OAAP,IAA2B;AACtC,MAAG,CAACD,OAAJ,EAAa;AACTA,IAAAA,OAAO,GAAG,MAAMH,OAAO,CAACK,YAAR,CAAqB;AACjCC,MAAAA,MAAM,EAAE,IADyB;AAEjCC,MAAAA,OAAO,EAAE;AAFwB,KAArB,CAAhB;AAIH;;AAED,QAAMC,MAAM,GAAG,MAAML,OAAO,CAACM,KAAR,CAAc;AAC/BC,IAAAA,WAAW,EAAE,CAAC,UAAD,CADkB;AAE/BC,IAAAA,MAAM,EAAE,IAFuB;AAG/BC,IAAAA,KAAK,EAAE,KAHwB;AAI/BC,IAAAA,OAAO,EAAE,CAACZ,eAAe,EAAhB,EAAoBC,WAAW,CAACE,OAAD,CAA/B,CAJsB;AAK/BU,IAAAA,MAAM,EAAE;AACJ,8BAAwB,cADpB;AAEJC,MAAAA,MAAM,EAAE;AAFJ;AALuB,GAAd,CAArB;AAWA,SAAOP,MAAM,CAACQ,WAAP,CAAmB,CAAnB,EAAsBC,IAA7B;AACH,CApBD","sourcesContent":["import * as esbuild from 'esbuild-wasm';\nimport { unpkgPathPlugin } from '../plugins/unpkg-path-plugins';\nimport { fetchPlugin } from '../plugins/fetch-plugin';\n\nlet service: esbuild.Service;\nexport default async (rawCode: string) => {\n    if(!service) {\n        service = await esbuild.startService({\n            worker: true,\n            wasmURL: 'https://unpkg.com/esbuild-wasm@0.8.27/esbuild.wasm',\n        });\n    }\n\n    const result = await service.build({\n        entryPoints: ['index.js'],\n        bundle: true,\n        write: false,\n        plugins: [unpkgPathPlugin(), fetchPlugin(rawCode)],\n        define: {\n            'process.env.NODE_ENV': '\"production\"',\n            global: 'window',\n        },\n    });\n\n    return result.outputFiles[0].text;\n};\n"]},"metadata":{},"sourceType":"module"}